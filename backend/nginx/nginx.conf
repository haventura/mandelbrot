user nginx;
# can handle 1000 concurrent connections
events {
	worker_connections   1000;
}
# forwards http requests
http {
	upstream api {
		least_conn;
		server backend_api_1:80; #max_conns=1;
		server backend_api_2:80;
		server backend_api_3:80;
		server backend_api_4:80;
		server backend_api_5:80;
		server backend_api_6:80;
		# queue 4096 timeout=3600; # only available with commercial subscription :/
	}
	# http server
	server {
		# listens the requests coming on port 80
		listen 80;
		access_log  off;
		# / means all the requests have to be forwarded to api service
		location / {
			# resolves the IP of api using Docker internal DNS
			proxy_pass http://api;
			proxy_read_timeout 3600;
		}
	}
}